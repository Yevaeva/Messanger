(this.webpackJsonpmessanger=this.webpackJsonpmessanger||[]).push([[0],{130:function(e,t,s){},131:function(e,t,s){},132:function(e,t,s){},133:function(e,t,s){},134:function(e,t,s){},135:function(e,t,s){},136:function(e,t,s){},137:function(e,t,s){},138:function(e,t,s){},140:function(e,t,s){"use strict";s.r(t);var n=s(0),a=s(1),c=s.n(a),r=s(69),i=s.n(r),o=(s(76),s(77),s(78),s(9)),l=s.p+"static/media/logo.8b1d0e4d.png",u=function(e){return Object(n.jsx)("div",{className:"background",children:Object(n.jsxs)("main",{children:[Object(n.jsx)("img",{src:l,alt:"Logo"}),Object(n.jsxs)("div",{className:"btnWrapper",children:[Object(n.jsx)(o.b,{to:"/register",exact:"true",className:"register",children:Object(n.jsx)("input",{type:"submit",value:"Register"})}),Object(n.jsx)(o.b,{to:"/sign-in",exact:"true",className:"signin",children:Object(n.jsx)("input",{type:"submit",value:"Sign in"})})]})]})})},j=s(2),d=s(20),m=s(21),b=s(22),h=s(24),p=s(23),O=(s(45),s(31)),f=s.n(O),g=f.a.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,onOpen:function(e){e.addEventListener("mouseenter",f.a.stopTimer),e.addEventListener("mouseleave",f.a.resumeTimer)}}),x=function(e,t){g.fire({icon:e,title:t})},v=function(e){Object(h.a)(s,e);var t=Object(p.a)(s);function s(e){var n;return Object(m.a)(this,s),(n=t.call(this,e)).handleChange=function(e,t){n.setState(Object(d.a)({},t,e.target.value))},n.handleSignUp=function(e){e.preventDefault();var t=n.state,s=t.email,a=t.password,c=t.name,r=t.surname;if(/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(s)&&a.length>4){var i={email:s,password:a,name:c,surname:r};fetch("http://localhost:8080/user/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)}).then((function(e){return e.json()})).then((function(e){if(e.error)throw e.error;e.error?console.log(e.error.message,"----response.mes"):(console.log("Successfull registration"),x("success",e.message),n.props.history.push("/home"))})).catch((function(e){console.log(e)}))}else alert("password must be gt 5")},n.state={email:"",password:"",name:"",surname:""},n}return Object(b.a)(s,[{key:"render",value:function(){var e=this;return Object(n.jsx)("div",{className:"background",children:Object(n.jsxs)("form",{onSubmit:this.handleSignUp,children:[Object(n.jsx)("div",{children:Object(n.jsxs)("label",{className:"label-email",children:[Object(n.jsx)("input",{type:"text",name:"Name",placeholder:"Name",required:!0,value:this.state.name,onChange:function(t){return e.handleChange(t,"name")}}),Object(n.jsx)("span",{className:"required",children:"Name"})]})}),Object(n.jsx)("div",{children:Object(n.jsxs)("label",{className:"label-email",children:[Object(n.jsx)("input",{type:"text",name:"Surname",placeholder:"Surname",required:!0,value:this.state.surname,onChange:function(t){return e.handleChange(t,"surname")}}),Object(n.jsx)("span",{className:"required",children:"Surname"})]})}),Object(n.jsx)("div",{children:Object(n.jsxs)("label",{className:"label-email",children:[Object(n.jsx)("input",{type:"email",className:"text",name:"email",placeholder:"Email",required:!0,value:this.state.email,onChange:function(t){return e.handleChange(t,"email")}}),Object(n.jsx)("span",{className:"required",children:"Email"})]})}),Object(n.jsx)("input",{type:"checkbox",name:"show-password",className:"show-password a11y-hidden",id:"show-password"}),Object(n.jsx)("label",{className:"label-show-password",htmlFor:"show-password",children:Object(n.jsx)("span",{children:"Show Password"})}),Object(n.jsx)("div",{children:Object(n.jsxs)("label",{className:"label-password",children:[Object(n.jsx)("input",{type:"text",className:"text",name:"password",placeholder:"Password",required:!0,value:this.state.password,onChange:function(t){return e.handleChange(t,"password")}}),Object(n.jsx)("span",{className:"required",children:"Password"})]})}),Object(n.jsx)("input",{type:"submit",value:"Sign up"}),Object(n.jsxs)("figure",{"aria-hidden":"true",children:[Object(n.jsx)("div",{className:"person-body"}),Object(n.jsx)("div",{className:"neck skin"}),Object(n.jsxs)("div",{className:"head skin",children:[Object(n.jsx)("div",{className:"eyes"}),Object(n.jsx)("div",{className:"mouth"})]}),Object(n.jsx)("div",{className:"hair"}),Object(n.jsx)("div",{className:"ears"}),Object(n.jsx)("div",{className:"shirt-1"}),Object(n.jsx)("div",{className:"shirt-2"})]})]})})}}]),s}(c.a.Component),N=s(42),y=s(33),w=s(17),S=s.n(w),T=s(32),E=s(4),C=s(39),k=s.n(C),I=s(15),M=s.n(I),A="NEW_CHAT_MESSAGE_EVENT",P="START_TYPING_MESSAGE_EVENT",_="STOP_TYPING_MESSAGE_EVENT",q="http://localhost:8080",U=function(e,t){var s=Object(a.useState)([]),n=Object(E.a)(s,2),c=n[0],r=n[1],i=Object(a.useState)([]),o=Object(E.a)(i,2),l=o[0],u=o[1],j=Object(a.useState)([]),d=Object(E.a)(j,2),m=d[0],b=d[1],h=Object(a.useState)(),p=Object(E.a)(h,2),O=p[0],f=p[1],g=Object(a.useRef)();Object(a.useEffect)((function(){(function(){var e=Object(T.a)(S.a.mark((function e(){var s,n;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M.a.get("".concat(q,"/user/:").concat(t));case 2:s=e.sent,n=s.data,console.log(n),f({picture:n.picture,name:n.name});case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]),Object(a.useEffect)((function(){(function(){var t=Object(T.a)(S.a.mark((function t(){var s,n;return S.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,M.a.get("".concat(q,"/rooms/").concat(e,"/users"));case 2:s=t.sent,n=s.data.users,u(n);case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}})()()}),[e]),Object(a.useEffect)((function(){(function(){var t=Object(T.a)(S.a.mark((function t(){var s,n;return S.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,M.a.get("".concat(q,"/rooms/").concat(e,"/messages"));case 2:s=t.sent,n=s.data.messages,r(n);case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}})()()}),[e]),Object(a.useEffect)((function(){if(O)return g.current=k()(q,{query:{roomId:e,name:O.name,picture:O.picture}}),g.current.on("connect",(function(){console.log(g.current.id)})),g.current.on("USER_JOIN_CHAT_EVENT",(function(e){console.log("user",e),console.log("socketRef.current",g.current),e.id!==g.current.id&&u((function(t){return[].concat(Object(y.a)(t),[e])}))})),g.current.on("USER_LEAVE_CHAT_EVENT",(function(e){u((function(t){return t.filter((function(t){return t.id!==e.id}))}))})),g.current.on(A,(function(e){console.log("message",e);var t=Object(N.a)(Object(N.a)({},e),{},{ownedByCurrentUser:e.senderId===g.current.id});console.log(t,"incomingMessage"),r((function(e){return[].concat(Object(y.a)(e),[t])})),console.log("messages",c)})),g.current.on(P,(function(e){if(e.senderId!==g.current.id){var t=e.user;b((function(e){return[].concat(Object(y.a)(e),[t])}))}})),g.current.on(_,(function(e){if(e.senderId!==g.current.id){var t=e.user;b((function(e){return e.filter((function(e){return e.name!==t.name}))}))}})),function(){g.current.disconnect()}}),[e,O]);return{messages:c,user:O,users:l,typingUsers:m,sendMessage:function(e){g.current&&g.current.emit(A,{body:e,senderId:g.current.id,user:O})},startTypingMessage:function(){g.current&&g.current.emit(P,{senderId:g.current.id,user:O})},stopTypingMessage:function(){g.current&&g.current.emit(_,{senderId:g.current.id,user:O})}}},F=(s(130),function(e){var t=Object(a.useState)(""),s=Object(E.a)(t,2),r=s[0],i=s[1],l=Object(a.useState)([]),u=Object(E.a)(l,2),j=(u[0],u[1]);c.a.useEffect((function(){M.a.get("http://localhost:8080/chatroom",{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then((function(e){j(e.data),console.log(e.data)})).catch((function(e){console.log(e)}))}),[]);return Object(n.jsxs)("div",{className:"home-container",children:[Object(n.jsx)("input",{type:"text",placeholder:"Room",value:r,onChange:function(e){i(e.target.value)},className:"text-input-field"}),Object(n.jsx)(o.b,{to:"/home/".concat(r,"/").concat(e.emailQuery),className:"enter-room-button",children:"Join room"})]})}),B=function(e){Object(h.a)(s,e);var t=Object(p.a)(s);function s(e){var n;return Object(m.a)(this,s),(n=t.call(this,e)).handleChange=function(e,t){n.setState(Object(d.a)({},t,e.target.value))},n.handleSignIn=function(e){e.preventDefault();if(/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(n.state.email)){var t={email:n.state.email,password:n.state.password};fetch("http://localhost:8080/user/sign-in",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then((function(e){return e.json()})).then((function(e){if(e.error)throw Error();if(!e.token)return x("error",e.message);x("success",e.message),localStorage.setItem("token",e.token),n.setState({emailQuery:t.email,bool:!1}),console.log("Login successfull"),console.log(e.message,"response.mes")})).catch((function(e){console.log(e)}))}},n.state={email:"",password:"",emailQuery:"",bool:!0},n}return Object(b.a)(s,[{key:"render",value:function(){var e=this;return Object(n.jsx)(n.Fragment,{children:this.state.bool?Object(n.jsx)("div",{className:"background",children:Object(n.jsxs)("form",{className:"login-form",onSubmit:this.handleSignIn,children:[Object(n.jsx)("h1",{className:"a11y-hidden",children:"Login Form"}),Object(n.jsx)("div",{children:Object(n.jsxs)("label",{className:"label-email",children:[Object(n.jsx)("input",{type:"email",className:"text",name:"email",placeholder:"Email",required:!0,value:this.state.email,onChange:function(t){return e.handleChange(t,"email")}}),Object(n.jsx)("span",{className:"required",children:"Email"})]})}),Object(n.jsx)("input",{type:"checkbox",name:"show-password",className:"show-password a11y-hidden",id:"show-password"}),Object(n.jsx)("label",{className:"label-show-password",htmlFor:"show-password",children:Object(n.jsx)("span",{children:"Show Password"})}),Object(n.jsx)("div",{children:Object(n.jsxs)("label",{className:"label-password",children:[Object(n.jsx)("input",{type:"text",className:"text",name:"password",placeholder:"Password",required:!0,value:this.state.password,onChange:function(t){return e.handleChange(t,"password")}}),Object(n.jsx)("span",{className:"required",children:"Password"})]})}),Object(n.jsx)("input",{type:"submit",value:"Log In"}),Object(n.jsx)("div",{className:"email",children:Object(n.jsx)("a",{href:"#",children:"Forgot password?"})}),Object(n.jsxs)("figure",{"aria-hidden":"true",children:[Object(n.jsx)("div",{className:"person-body"}),Object(n.jsx)("div",{className:"neck skin"}),Object(n.jsxs)("div",{className:"head skin",children:[Object(n.jsx)("div",{className:"eyes"}),Object(n.jsx)("div",{className:"mouth"})]}),Object(n.jsx)("div",{className:"hair"}),Object(n.jsx)("div",{className:"ears"}),Object(n.jsx)("div",{className:"shirt-1"}),Object(n.jsx)("div",{className:"shirt-2"})]})]})}):Object(n.jsx)(F,{emailQuery:this.state.emailQuery})})}}]),s}(c.a.Component),L=function(e){Object(h.a)(s,e);var t=Object(p.a)(s);function s(){return Object(m.a)(this,s),t.apply(this,arguments)}return Object(b.a)(s,[{key:"render",value:function(){return Object(n.jsxs)("div",{children:[Object(n.jsx)("h1",{children:"Error 404"}),Object(n.jsx)("h2",{children:"Page not found \ud83d\ude16"})]})}}]),s}(c.a.Component),R=(s(131),s(132),s(133),function(e){var t=e.user;return Object(n.jsx)(n.Fragment,{children:Object(n.jsx)("img",{src:t.picture,alt:t.name,title:t.name,className:"avatar"})})}),J=(s(134),function(e){var t=e.message;return Object(n.jsxs)("div",{className:"message-item ".concat(t.ownedByCurrentUser?"my-message":"received-message"),children:[!t.ownedByCurrentUser&&Object(n.jsx)("div",{className:"message-avatar-container",children:Object(n.jsx)(R,{user:t.user})}),Object(n.jsxs)("div",{className:"message-body-container",children:[!t.ownedByCurrentUser&&Object(n.jsx)("div",{className:"message-user-name",children:t.user.name}),Object(n.jsx)("div",{className:"message-body",children:t.body})]})]})}),V=function(){var e=Object(a.useState)(!1),t=Object(E.a)(e,2),s=t[0],n=t[1],c=Object(a.useState)(!1),r=Object(E.a)(c,2),i=r[0],o=r[1],l=Object(a.useState)(5),u=Object(E.a)(l,2),j=u[0],d=u[1];return Object(a.useEffect)((function(){var e;return i?(i||0===j)&&clearInterval(e):e=setInterval((function(){d((function(e){return e-1}))}),1e3),0===j&&n(!1),function(){return clearInterval(e)}}),[i,j]),{isTyping:s,startTyping:function(){o(!0),d(5),n(!0)},stopTyping:function(){o(!1)},cancelTyping:function(){d(0)}}},z=(s(135),function(e){var t=e.newMessage,s=e.handleNewMessageChange,a=e.handleStartTyping,c=e.handleStopTyping,r=e.handleSendMessage;return Object(n.jsxs)("form",{className:"new-message-form",children:[Object(n.jsx)("input",{type:"text",value:t,onChange:s,placeholder:"Aa",className:"new-message-input-field",onKeyPress:a,onKeyUp:c}),Object(n.jsx)("button",{type:"submit",onClick:r,className:"send-message-button",children:"Send"})]})}),G=(s(136),function(){return Object(n.jsxs)("div",{className:"dotsContainer",children:[Object(n.jsx)("span",{id:"dot1"}),Object(n.jsx)("span",{id:"dot2"}),Object(n.jsx)("span",{id:"dot3"})]})}),Q=(s(137),function(e){var t=e.user;return Object(n.jsxs)("div",{className:"message-item",children:[Object(n.jsx)("div",{className:"message-avatar-container",children:Object(n.jsx)("img",{src:t.picture,alt:t.name,className:"message-avatar"})}),Object(n.jsx)(G,{})]})}),D=(s(138),function(e){var t=e.users;return t.length>0?Object(n.jsxs)("div",{children:[Object(n.jsx)("h2",{children:"Also in this room:"}),Object(n.jsx)("ul",{className:"user-list",children:t.map((function(e,t){return Object(n.jsxs)("li",{className:"user-box",children:[Object(n.jsx)("span",{children:e.name}),Object(n.jsx)(R,{user:e})]},t)}))})]}):Object(n.jsx)("div",{children:"There is no one else in this room"})}),Z=function(e){var t=e.match.params,s=t.roomId,c=t.email,r=U(s,c),i=r.messages,o=r.user,l=r.users,u=r.typingUsers,j=r.sendMessage,d=r.startTypingMessage,m=r.stopTypingMessage,b=Object(a.useState)(""),h=Object(E.a)(b,2),p=h[0],O=h[1],f=V(),g=f.isTyping,x=f.startTyping,v=f.stopTyping,N=f.cancelTyping;return Object(a.useEffect)((function(){g?d():m()}),[g]),Object(n.jsxs)("div",{className:"chat-room-container",children:[Object(n.jsxs)("div",{className:"chat-room-top-bar",children:[Object(n.jsxs)("h1",{className:"room-name",children:["Room: ",s]}),o&&Object(n.jsx)(R,{user:o})]}),Object(n.jsx)(D,{users:l}),Object(n.jsx)("div",{className:"messages-container",children:Object(n.jsxs)("ol",{className:"messages-list",children:[i.map((function(e,t){return Object(n.jsx)("li",{children:Object(n.jsx)(J,{message:e})},t)})),u.map((function(e,t){return Object(n.jsx)("li",{children:Object(n.jsx)(Q,{user:e})},i.length+t)}))]})}),Object(n.jsx)(z,{newMessage:p,handleNewMessageChange:function(e){O(e.target.value)},handleStartTyping:x,handleStopTyping:v,handleSendMessage:function(e){e.preventDefault(),N(),j(p),O("")}})]})};var H=function(){return Object(n.jsx)("div",{className:"App",children:Object(n.jsxs)(j.d,{children:[Object(n.jsx)(j.b,{path:"/",exact:!0,component:u}),Object(n.jsx)(j.b,{exact:!0,path:"/home",component:F}),Object(n.jsx)(j.b,{exact:!0,path:"/home/:roomId/:email",component:Z}),Object(n.jsx)(j.b,{path:"/register",exact:!0,component:v}),Object(n.jsx)(j.b,{path:"/sign-in",exact:!0,component:B}),Object(n.jsx)(j.b,{path:"/404",exact:!0,component:L}),Object(n.jsx)(j.a,{to:"/404"})]})})},K=function(e){e&&e instanceof Function&&s.e(3).then(s.bind(null,141)).then((function(t){var s=t.getCLS,n=t.getFID,a=t.getFCP,c=t.getLCP,r=t.getTTFB;s(e),n(e),a(e),c(e),r(e)}))};s(139);i.a.render(Object(n.jsx)(o.a,{basename:"/Messanger",children:Object(n.jsx)(c.a.StrictMode,{children:Object(n.jsx)(H,{})})}),document.getElementById("root")),K()},45:function(e,t,s){},76:function(e,t,s){},77:function(e,t,s){},78:function(e,t,s){}},[[140,1,2]]]);
//# sourceMappingURL=main.92b1afaa.chunk.js.map